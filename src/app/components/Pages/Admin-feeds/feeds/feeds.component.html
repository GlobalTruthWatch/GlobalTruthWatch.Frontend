<div class="feeds-page">
  <div class="topbar">
    <div class="title">
      <h1>Latest News</h1>
      <p class="subtitle">Realtime feed — sourced from your RSS collector</p>
    </div>

    <div class="controls">
      <input [formControl]="searchCtl" type="search" placeholder="Search headlines, summaries, sources..." aria-label="Search feeds" />
      <select [value]="category" (change)="setCategory($any($event.target).value)">
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="state">Loading feeds…</div>
  <div *ngIf="error" class="state error">{{ error }}</div>
  <div *ngIf="!loading && !error && filtered?.length === 0" class="state">No feeds found.</div>

  <div class="grid">
    <article *ngFor="let f of filtered | slice:0:displayCount" class="card">
      <div class="card-media" role="link" tabindex="0" [routerLink]="['/admin/feeds', f.id]">
        <img [src]="getImageUrl(f)" (error)="onImageError($event)" alt="{{ f.title }}" class="img-fluid rounded shadow-sm w-100"/>
      </div>

      <div class="card-body">
        <h2 class="card-title">
          <a [routerLink]="['/admin/feeds', f.id]">{{ f.title }}</a>
        </h2>
        <p class="card-summary">{{ truncate(f.summary || f.content, 180) }}</p>

        <div class="meta">
          <span class="source">{{ f.sourceName || 'Unknown' }}</span>
          <span class="dot">•</span>
          <time [attr.datetime]="f?.publishedAt">{{ f?.publishedAt ? (f?.publishedAt | date:'medium') : '—' }}</time>
        </div>

        <!-- <div class="mt-3 text-end">
          <a class="btn btn-outline-primary" [routerLink]="['/admin/feeds', f.id]">View Details</a>
        </div> -->
      </div>
    </article>
  </div>

  <div class="footer-controls" *ngIf="(filtered?.length || 0) > displayCount">
    <button class="btn-outline" (click)="showMore()">Load more</button>
  </div>
</div>
